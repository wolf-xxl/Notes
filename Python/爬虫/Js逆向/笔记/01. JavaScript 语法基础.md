[https://www.yuque.com/tuling_python/js_reverse](https://www.yuque.com/tuling_python/js_reverse)   密码：vx6c
[https://www.yuque.com/tuling_python/new_basic](https://www.yuque.com/tuling_python/new_basic)  密码：ffqv

> 学习目标
1. 逆向工具准备
2. 熟悉逆向的基本过程
3. 熟悉`JavaScript`语法


## 1. 前期准备

### 技术准备
- **`Python`基础语法**：作为对比学习的基础
- **爬虫基础功底**：理解数据获取原理
- **`JavaScript`基础语法知识**：核心学习内容

### 工具准备
```bash
# 安装nvm（Node.js版本管理工具）
# Windows下载地址：https://github.com/coreybutler/nvm-windows/releases
# MacOS安装：brew install nvm

# nvm基础指令
nvm list          # 列出所有已安装的node版本
nvm install 16    # 安装指定版本的node，16指的是node版本
nvm use 16        # 切换到指定的node版本

node # 进入 node.js 环境
```

## 2. `JavaScript`逆向简介

### 基本概念

- `JavaScript`逆向：分析理解加密代码的过程
- 目标：通过`Python`模拟`JavaScript`加密过程，而不是解密

### 常见加密类型

> **请求加密（`POST`）**：
	`sign`
	`ts`
	`token`
	`cookie`
	表单加密
	载荷加密
	查询字符串加密

`https://www.qcc.com/web/search?key=%E5%B0%8F%E7%B1%B3&p=2`

> **请求参数加密（`GET`）**：

`https://www.jizhy.com/44/rank/school`
`
> **`Cookie`验证**：

`https://q.10jqka.com.cn/`

> **响应数据验证**：
> 	接口返回的数据是加密的

`https://www.swguancha.com/home/ranking-list?code=td&tabName=city`

> **全加密**：

`http://www.birdreport.cn/home/search/report.html?search=eyJ0YXhvbmlkIjoiliwic3RhcnRUaw1lIjoiliwiZW5kVGltZSI6IiIsInByb3ZpbmNlIjoi6Z2S5rW355yBIiwiY210eSI6IiIsImRpc3RyaWNOIjoiIiwicG9pbnRuYw1lIjoiIiwidXNlcm5hbwuioiIiLCJzZXJpYwxfawQioiIiLCJjdGltZSI6IiIsInRheG9ubmFtZSI6IiIsInNOYXRlIjoiliwibw9kZSI6IjAiLCJvdXRzaWRlX3R5cGUiojB9`

## 3. 变量与数据类型

### 变量定义
```javascript
// JavaScript是弱类型语言，变量类型由值决定
var username = "张三";      // 字符串
var age = 25;              // 数字
var isStudent = true;      // 布尔值
var score = 95.5;          // 浮点数
var emptyValue = null;     // 空值
var undefinedValue;        // 未定义，值为undefined

var a = 1; b = 2; c = 3;// 同时定义多个变量
data = 4; // 不加 let, var 会将变量挂载到顶级对象中（了解即可）

var i = `${a}`  // 模板字符串
// 使用分号结尾（推荐）
console.log(username);
```

> 在正向开发中 `var`已经被遗弃，因为可能会导致作用域混乱
### 数据类型详解
```javascript
/* JavaScript六种数据类型 */
// 1. 数字类型 (number)
var intNum = 100;          // 1.整数
var floatNum = 3.14;       // 2.浮点数
var scientificNum = 1.5e3; // 3.科学计数法：1500

// 2. 字符串类型 (string)
var singleQuote = '单引号字符串';
var doubleQuote = "双引号字符串";
var templateString = `模板字符串，可以嵌入变量：${intNum}`;

// 3. 布尔类型 (boolean)
var isTrue = true;  
var isFalse = false;

// 4. undefined类型
var undefinedVar;          // 声明未赋值，值为undefined

// 5. null类型
var nullVar = null;        // 明确表示为空值

// 6. 对象类型 (object)
var person = {
    name: "李四",
    age: 30,
    isMarried: false
};

// 使用typeof检测数据类型
console.log(typeof intNum);           // "number"
console.log(typeof singleQuote);      // "string"  
console.log(typeof isTrue);           // "boolean"
console.log(typeof undefinedVar);     // "undefined"
console.log(typeof nullVar);          // "object" (这是JavaScript的历史遗留问题)
console.log(typeof person);           // "object"
```

### 变量命名规范
```javascript
// 正确命名
var userName;       // 驼峰命名法
var _privateVar;    // 下划线开头
var $element;       // 美元符号开头
var user1;          // 包含数字

// 错误命名
// var 123abc;      // 不能以数字开头
// var user-name;   // 不能包含连字符
// var var;         // 不能使用关键字
```

## 4. 函数的定义与使用

### 基础函数
```javascript
// 1. 函数定义与调用
function sayHello() {
    console.log("Hello, World!");
}
sayHello(); // 调用函数

// 2. 带参数的函数
function greet(name) {
    console.log("你好，" + name);
}
greet("张三"); // 输出：你好，张三

// 3. 带返回值的函数
function add(a, b) {
    return a + b;
}
var result = add(5, 3);
console.log(result); // 输出：8
```

### 函数进阶特性
```javascript
// 1. 接收不定数量参数
function sum() {
    // arguments是函数内置对象，包含所有传入参数
    var total = 0;
    for (var i = 0; i < arguments.length; i++) {
        total += arguments[i];
    }
    return total;
}
console.log(sum(1, 2, 3, 4, 5)); // 输出：15

// 2. 函数返回多个值（实际返回最后一个）
function multipleReturns() {
    return 1, 2, 3; // 实际只返回3
}
console.log(multipleReturns()); // 输出：3

// 3. 自执行函数（立即调用函数表达式），类似python中的匿名函数
!function() {
    console.log("自执行函数 - 1");
}(); // 定义后立即调用

(function(){
console.log('自执行函数 - 2')})();

// 4. 函数嵌套，类似python中的装饰器
var outerFunc;
!function() {
    function innerFunc() {
        console.log("这是内部函数");
    }
    outerFunc = innerFunc; // 将内部函数暴露到外部
}(); // 立即执行，将函数 innerfunc 赋值给 outerfunc
outerFunc(); // 输出：这是内部函数

```


## 5. 变量作用域

### 作用域类型
```javascript
// 全局变量 - 在函数外部定义
var globalVar = "我是全局变量";

function testScope() {
    // 局部变量 - 在函数内部定义
    var localVar = "我是局部变量";
    console.log(globalVar); // 可以访问全局变量
    console.log(localVar);  // 可以访问局部变量
}

testScope();
console.log(globalVar); // 可以访问全局变量
// console.log(localVar); // 错误！无法访问局部变量
```

### 变量声明方式
```javascript
// 1. var - 函数作用域
function varTest() {
    if (true) {
        var x = 10; // var是函数作用域
    }
    console.log(x); // 输出：10，在if块外仍可访问
}

// 2. let - 块级作用域  
function letTest() {
    if (true) {
        let y = 20; // let是块级作用域
        console.log(y); // 输出：20
    }
    // console.log(y); // 错误！y在if块外不可访问
}

// 3. const - 常量声明（块级作用域）
const PI = 3.14159;
// PI = 3.14; // 错误！常量不可重新赋值

const user = { name: "张三" };
user.name = "李四"; // 允许！可以修改对象属性
// user = { name: "王五" }; // 错误！不能重新赋值
```

## 6. 条件语句

### 基础条件判断
```javascript
var score = 85;

// 1. if 语句
if (score >= 60) {
    console.log("及格");
}

// 2. if...else 语句
if (score >= 90) {
    console.log("优秀");
} else {
    console.log("良好");
}

// 3. if...else if...else 语句
if (score >= 90) {
    console.log("A");
} else if (score >= 80) {
    console.log("B");
} else if (score >= 70) {
    console.log("C");
} else {
    console.log("D");
}
```

### 比较运算符
```javascript
var x = 5;
var y = "5";

console.log(x == y);   // true - 值相等
console.log(x === y);  // false - 值和类型都相等
console.log(x != y);   // false - 值不相等  
console.log(x !== y);  // true - 值或类型不相等
console.log(x > 3);    // true
console.log(x < 10);   // true
console.log(x >= 5);   // true
console.log(x <= 5);   // true
```

### 逻辑运算符
```javascript
var age = 25;
var hasLicense = true;

// 逻辑与 (&&) - 两个条件都为真
if (age >= 18 && hasLicense) {
    console.log("可以开车");
}

// 逻辑或 (||) - 至少一个条件为真
if (age < 6 || age >= 65) {
    console.log("可以享受优惠");
}

// 逻辑非 (!) - 取反
if (!hasLicense) {
    console.log("不能开车");
}
```

### 三目运算符
```javascript
var age = 20;
var message = age >= 18 ? "成年人" : "未成年人";
console.log(message); // 输出：成年人

// 等价于：
if (age >= 18) {
    message = "成年人";
} else {
    message = "未成年人";
}
```

### `Switch`语句
```javascript
var day = new Date().getDay(); // 获取当前星期（0-6）

switch (day) {
    case 0:
        console.log("星期日");
        break;
    case 1:
        console.log("星期一");
        break;
    case 2:
        console.log("星期二");
        break;
    case 3:
        console.log("星期三");
        break;
    case 4:
        console.log("星期四");
        break;
    case 5:
        console.log("星期五");
        break;
    case 6:
        console.log("星期六");
        break;
    default:
        console.log("未知日期");
}
// 注意：case后面不加break，会继续执行后面的case
```

## 7. 数组

### 数组基础操作
```javascript
// 1. 数组定义
var fruits = ["苹果", "香蕉", "橙子"];
var mixedArray = [1, "hello", true, null]; // 可以包含不同类型

// 2. 访问数组元素
console.log(fruits[0]); // "苹果" - 索引从0开始
console.log(fruits.length); // 3 - 数组长度

// 3. 修改数组元素
fruits[1] = "葡萄";
console.log(fruits); // ["苹果", "葡萄", "橙子"]
```

### 数组常用方法
```javascript
var numbers = [1, 2, 3, 4, 5];

// 1. 末尾操作
numbers.push(6); // 末尾添加： [1, 2, 3, 4, 5, 6]
var last = numbers.pop(); // 末尾删除，返回删除的元素：6

// 2. 开头操作  
numbers.unshift(0); // 开头添加：[0, 1, 2, 3, 4, 5]
var first = numbers.shift(); // 开头删除，返回删除的元素：0

// 3. 指定位置操作
numbers.splice(1, 2, "a", "b"); 
// 从索引1开始删除2个元素，然后添加"a", "b"
// 结果：[1, "a", "b", 4, 5]
numbers.splice(1, 0, 'd', 4)
// 在索引1的位置添加 'd', 4

// 4. 多维数组
var matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];
console.log(matrix[1][2]); // 6 - 第二行第三列
```

## 8. 循环语句

### `For`循环
```javascript
var fruits = ["苹果", "香蕉", "橙子", "葡萄"];

// 1. 基础for循环
for (var i = 0; i < fruits.length; i++) {
    console.log("水果：" + fruits[i]);
}

// 2. for...in循环（遍历对象属性或数组索引）
for (var index in fruits) {
    console.log("索引：" + index + ", 值：" + fruits[index]);
}

// 3. for...of循环（遍历数组值，ES6新增）
for (var fruit of fruits) {
    console.log("水果：" + fruit);
}
```

### `While`循环
```javascript
var numbers = [10, 20, 30, 40, 50];

// 1. while循环
var i = 0;
while (i < numbers.length) {
    console.log(numbers[i]);
    i++;
}

// 2. do...while循环（至少执行一次）
var j = 0;
do {
    console.log(numbers[j]);
    j++;
} while (j < numbers.length);
```

### 循环控制
```javascript
for (var i = 0; i < 10; i++) {
    if (i === 3) {
        continue; // 跳过本次循环，继续下一次
    }
    if (i === 7) {
        break; // 终止整个循环
    }
    console.log(i); // 输出：0, 1, 2, 4, 5, 6
}
```

## 9. 对象

### 对象创建方式
```javascript
// 1. 字面量创建（最常用）
var person = {
    name: "张三",
    age: 25,
    sayHello: function() {
        console.log("你好，我是" + this.name);
    }
};

// 2. new Object()创建
var car = new Object();
car.brand = "Toyota";
car.color = "red";
car.drive = function() {
    console.log("驾驶中...");
};

// 3. 构造函数创建
function Student(name, grade) {
    this.name = name;
    this.grade = grade;
    this.study = function() {
        console.log(this.name + "正在学习");
    };
}
var student1 = new Student("李四", "三年级");
```

### 类（`ES6`）
```javascript
class Person {
    // 构造函数
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }

    // 私有方法（ES2022新增）
    #privateMethod() {
        console.log("这是私有方法");
    }

    // 静态方法
    static staticMethod() {
        console.log("这是静态方法");
    }

    // 实例方法
    introduce() {
        console.log(`我叫${this.name}，今年${this.age}岁`);
    }

    // 调用私有方法
    callPrivate() {
        this.#privateMethod();
    }
}

// 使用类
var person1 = new Person("王五", 30);
person1.introduce(); // 我叫王五，今年30岁
Person.staticMethod(); // 这是静态方法（通过类名调用）
person1.callPrivate(); // 这是私有方法
```

### 对象操作
```javascript
var user = {
    username: "admin",
    email: "admin@example.com",
    age: 28
};

// 访问属性
console.log(user.username); // admin
console.log(user["email"]); // admin@example.com

// 添加属性
user.phone = "13800138000";

// 删除属性
delete user.age;

// 检查属性是否存在
console.log("username" in user); // true
console.log(user.hasOwnProperty("email")); // true

// 遍历对象属性
for (var key in user) {
    console.log(key + ": " + user[key]);
}
```

## 10. 定时器

### 定时器类型
```javascript
// 1. setTimeout - 一次性定时器
function sayHello() {
    console.log("Hello! 3秒后执行");
}

var timeoutId = setTimeout(sayHello, 3000); 
// 3秒后执行一次

// 清除定时器
// clearTimeout(timeoutId);

// 2. setInterval - 重复定时器
var counter = 0;
function countUp() {
    counter++;
    console.log("计数: " + counter);
    if (counter >= 5) {
        clearInterval(intervalId); // 停止计时器
    }
}

var intervalId = setInterval(countUp, 1000);
// 每1秒执行一次
```

### 定时器进阶用法
```javascript
// 1. 带参数的定时器
function greet(name, message) {
    console.log(name + ", " + message);
}

setTimeout(greet, 2000, "张三", "你好！");

// 2. 使用箭头函数
setTimeout(() => {
    console.log("这是箭头函数定时器");
}, 1000);

// 3. 方法置空（防止定时器执行）
setInterval = function() {
    arguments[0](); // 只执行函数，不创建真正的定时器
};

setInterval(function() {
    console.log("这个定时器被重写了");
}, 2000);
```

## 11. 异步编程

### 回调函数与异步
```javascript
console.log("开始执行");

// 同步代码 - 立即执行
for (let i = 0; i < 3; i++) {
    console.log("同步任务 " + i);
}

// 异步代码 - 延迟执行
setTimeout(() => {
    console.log("异步任务完成");
}, 0);

console.log("继续执行");

/* 输出顺序：
   开始执行
   同步任务 0
   同步任务 1  
   同步任务 2
   继续执行
   异步任务完成
*/

// 回调地狱：嵌套的定时器，不要这样用，了解即可  
setTimeout(()=>{  
    console.log('第一层')  
    setTimeout(()=>{  
        console.log('第二层')  
        setTimeout(()=>{  
            console.log('第三层')  
        },1000)  
    },1000)  
},1000)
```

### `Promise`
```javascript
// 1. Promise基础
function asyncTask() {
    return new Promise(function(resolve, reject) {
        setTimeout(function() {
            var success = Math.random() > 0.5;
            if (success) {
                resolve("任务成功完成");
            } else {
                reject("任务失败");
            }
        }, 1000);
    });
}

// 使用Promise
asyncTask()
    .then(function(result) {
        console.log("成功:", result);
    })
    .catch(function(error) {
        console.log("失败:", error);
    });

// 2. Promise链式调用
function step1() {
    return new Promise(resolve => {
        setTimeout(() => {
            console.log("第一步完成");
            resolve("第一步结果");
        }, 1000);
    });
}

function step2(previousResult) {
    return new Promise(resolve => {
        setTimeout(() => {
            console.log("第二步完成，上一步结果:", previousResult);
            resolve("第二步结果");
        }, 1000);
    });
}

function step3(previousResult) {
    return new Promise(resolve => {
        setTimeout(() => {
            console.log("第三步完成，上一步结果:", previousResult);
            resolve("最终结果");
        }, 1000);
    });
}

// 链式调用
step1()
    .then(step2)
    .then(step3)
    .then(finalResult => {
        console.log("所有步骤完成:", finalResult);
    });
```

### `async`/`await`
```javascript
// 使用async/await简化Promise
async function runAsyncTasks() {
    try {
        const result1 = await step1();
        const result2 = await step2(result1);
        const result3 = await step3(result2);
        console.log("最终结果:", result3);
    } catch (error) {
        console.log("发生错误:", error);
    }
}

runAsyncTasks();

// 箭头函数形式的async函数
const fetchData = async () => {
    const response = await fetch('https://api.example.com/data');
    const data = await response.json();
    return data;
};
```

## 12. `JSON`数据格式

### `JSON`基础
```javascript
// 1. JSON对象格式
var personJSON = {
    "name": "张三",
    "age": 25,
    "isStudent": false,
    "hobbies": ["读书", "游泳", "编程"],
    "address": {
        "city": "北京",
        "street": "朝阳路"
    }
};

// 2. JSON数组格式
var usersJSON = [
    {"name": "用户1", "age": 20},
    {"name": "用户2", "age": 25},
    {"name": "用户3", "age": 30}
];

// 3. JSON与JavaScript对象转换
var jsonString = '{"name": "李四", "age": 30}';

// JSON字符串转JavaScript对象
var jsonObj = JSON.parse(jsonString);
console.log(jsonObj.name); // 李四

// JavaScript对象转JSON字符串
var objToString = JSON.stringify(jsonObj);
console.log(objToString); // '{"name":"李四","age":30}'
```

### `JSON`注意事项
```javascript
// 正确的JSON格式
var correctJSON = {
    "name": "张三",     // 键必须用双引号
    "age": 25,         // 值可以是数字、字符串、布尔值、数组、对象、null
    "active": true,    // 布尔值
    "tags": ["a", "b"], // 数组
    "profile": null    // null值
};

// 错误的JSON格式
var wrongJSON = {
    name: "张三",      // 错误：键没有双引号
    'age': 25,        // 错误：键使用单引号
    undefined: "值"    // 错误：值不能是undefined
    // 最后一个属性后面不能有逗号
};
```

## 13. `Ajax`通信

### 基础`Ajax`请求
```javascript
// 使用XMLHttpRequest
function makeAjaxRequest(url, method = 'GET', data = null) {
    return new Promise(function(resolve, reject) {
        var xhr = new XMLHttpRequest();
        
        xhr.open(method, url, true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    resolve(JSON.parse(xhr.responseText));
                } else {
                    reject(new Error('请求失败: ' + xhr.status));
                }
            }
        };
        
        xhr.onerror = function() {
            reject(new Error('网络错误'));
        };
        
        xhr.send(data ? JSON.stringify(data) : null);
    });
}

// 使用示例
makeAjaxRequest('https://api.example.com/users')
    .then(function(response) {
        console.log('获取数据成功:', response);
    })
    .catch(function(error) {
        console.log('获取数据失败:', error);
    });
```

### `Fetch API`（现代方式）
```javascript
// 使用fetch进行Ajax请求
async function fetchData(url, options = {}) {
    try {
        const response = await fetch(url, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                ...options.headers
            },
            ...options
        });
        
        if (!response.ok) {
            throw new Error(`HTTP错误! 状态: ${response.status}`);
        }
        
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('请求失败:', error);
        throw error;
    }
}

// 使用示例
fetchData('https://jsonplaceholder.typicode.com/posts')
    .then(posts => {
        console.log('获取文章列表:', posts.slice(0, 3));
    })
    .catch(error => {
        console.error('错误:', error);
    });
```

## 14. `Window`对象与`BOM`

### `Window`对象属性
```javascript
// 在浏览器环境中，window是全局对象
console.log(window); // 在浏览器中输出window对象

// 常用window属性
console.log(window.innerWidth);    // 视口宽度
console.log(window.innerHeight);   // 视口高度
console.log(window.location.href); // 当前URL
console.log(window.navigator.userAgent); // 浏览器信息
```

### `Location`对象
```javascript
// 操作浏览器地址
console.log(location.href);     // 完整URL
console.log(location.protocol); // 协议 (http: 或 https:)
console.log(location.hostname); // 域名
console.log(location.pathname); // 路径
console.log(location.search);   // 查询参数

// 页面跳转
// location.href = 'https://www.baidu.com'; // 跳转到百度
// location.reload(); // 重新加载页面
```

### `History`对象
```javascript
// 操作浏览器历史记录
// history.back();    // 后退
// history.forward(); // 前进  
// history.go(-2);    // 后退2页
// history.go(1);     // 前进1页

console.log(history.length); // 历史记录数量
```

### `Document`对象（`DOM`）
```javascript
// 文档对象操作
console.log(document.title); // 页面标题
// document.title = "新标题"; // 修改标题

// 获取元素
var element = document.getElementById('myId');
var elements = document.getElementsByClassName('myClass');
var tags = document.getElementsByTagName('div');

// 现代选择器
var firstMatch = document.querySelector('.container');
var allMatches = document.querySelectorAll('.item');

// 创建元素
var newDiv = document.createElement('div');
var newText = document.createTextNode('Hello World');

// 输出内容
document.write('直接写入文档');
document.writeln('写入并换行');
```

### `Screen`对象
```javascript
// 屏幕信息
console.log(screen.width);        // 屏幕宽度
console.log(screen.height);       // 屏幕高度  
console.log(screen.availWidth);   // 可用宽度
console.log(screen.availHeight);  // 可用高度
console.log(screen.colorDepth);   // 颜色深度
```

### `Navigator`对象
```JavaScript

```


### `LocalStorage`对象
```JavaScript
// cookie 反爬虫
```

### `SessionStorage`对象
```JavaScript

```

### `EventTarget`对象
```JavaScript

```

## 总结

#### 重点内容

> 1. `promise`任务函数的基本结构
> 2. `json`对象：
> 	1. `JSON.stringifh()`将对象转为字符串
> 	2. `JSON.parse()`将字符串转为对象
> 3. `ajax`异步请求的基本结构
	   `url`
	   `method`
	   `dataType`
	   `async`
	   `success`
	   `error`

```javascript
// 综合示例：模拟登录请求
async function simulateLogin(username, password) {
    // 通常在实际逆向中，这里会有复杂的加密逻辑
    const encryptedData = {
        username: btoa(username), // base64编码
        password: btoa(password),
        timestamp: Date.now()
    };
    
    try {
        const response = await fetch('/api/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest'
            },
            body: JSON.stringify(encryptedData)
        });
        
        return await response.json();
    } catch (error) {
        console.error('登录请求失败:', error);
        throw error;
    }
}
```
